version: '3'
# - Remember you need to have:
# - bluez bluetooth stack installed on your host machine
# - Login and have configured your Cync devices
# - Done the cync2mqtt login with 2fa and generated cync_mesh.yaml
# - Configured the mqtt broker in cync_mesh.yaml; see cync_mesh_example.yaml
services:
  cync2mqtt:
    container_name: cync2mqtt
    image: cync2mqtt:baudneo
    restart: unless-stopped
    build:
      dockerfile: ../Dockerfile
      context: src
    volumes:
      - ~/docker/cync2mqtt:/home/cync2mqtt
      # - Access to dbus for bluez bluetooth stack communication
      - /var/run/dbus/:/var/run/dbus/:z
    environment:
      # - Set the timezone for the container
      TZ: "America/Edmonton"
      # - For debug logging set DEBUG to one of 1, true, yes, t, y
      DEBUG: 1
    privileged: true
    networks:
      - cync2mqtt
    command: [ "cync2mqtt", "/home/cync2mqtt/cync_mesh.yaml"]
    # - For debug logging
    #command: [ "cync2mqtt", "/home/cync2mqtt/cync_mesh.yaml", "--log-level", "DEBUG" ]

networks:
    cync2mqtt:
        driver: bridge
